---
title: "DataExpert.io - Week 1 Homework Part 2 - Data Engineering Bootcamp"
author:
  - "Jade Codes"
published: 2024-11-23
source: "https://www.youtube.com/watch?v=hXIf1HT-Dfk&t=5512s"
image: "https://i.ytimg.com/vi/hXIf1HT-Dfk/maxresdefault.jpg?sqp=-oaymwEmCIAKENAF8quKqQMa8AEB-AH-CYAC0AWKAgwIABABGGUgZShlMA8=&rs=AOn4CLBQjKpZmzl3stCDJ2t1qfKvDnQ7CQ"
created: 2025-03-23
tags:
  - "youtube"
  - "Data_Engineering"
  - "SQL_Analysis"
  - "Bootcamp_Homework"
summary: "Data Engineering Bootcamp homework review. SQL queries to analyze actor data and movie ratings. Debugging and problem-solving approach."
---
# DataExpert.io - Week 1 Homework Part 2 - Data Engineering Bootcamp

![DataExpert.io - Week 1 Homework Part 2 - Data Engineering Bootcamp](https://www.youtube.com/embed/hXIf1HT-Dfk&t=5512s)

> [!summary]- Description
> Thank you for joining me on my Data Engineering Bootcamp journey!
> 
> I'm so excited to have you here as we work through this incredible free bootcamp together. A huge shoutout to Zach for creating such an amazing resource!  
> 
> Before we dive in, let’s go over a few quick house rules:  
> 1️⃣ If you’re also following along with the bootcamp, make sure you check out the official site at:
> https://bootcamp.techcreator.io/ 
> 2️⃣ Don’t forget to watch Zach's videos directly too! He deserves the watch hours, and you deserve the credit for completing the bootcamp.  
> 
> This bootcamp is completely free, but I also want to let you know I’ll be joining Zach's paid bootcamp in January. 
> 
> If you're interested in leveling up your skills even further, you can use my link for 20% off: 
> https://www.dataexpert.io/jade
> 
> Thank you again for being here, let’s make the most of this bootcamp and learn some amazing skills together!

> [!note]- Transcript (Youtube)
> that for okay right so welcome to everyone who's joined um so I had a bit of a a a thought whilst I was in the car and I think I think that I don't need to do this right now so what I'm going to do is I'm going to remove this for now and I'm going to just F I'm going to try and break it up a little bit more to do the bit step by step than trying to do it all at once which is what I was trying to do so this is I'm going to remove this out and then do this after I've done the actual um like joining the the values together so um I'm just going to remove that and I'm going to put it over here so I don't lose it but I'm going to comment this out and I'm going to remove the that's I don't think I need to remove anything else I think that should be fine and then I don't think we should have any duplicates here no we don't which is great really good and I'm just going to like move this value to 2,000 and I just want to see that the aggregation is working like I expect it to so I'm just going to do that now so we got year 20 2021 2022 yeah 2021 2022 okay so it's still still it's giving me duplicates here rather than giving me just the one okay okay I think I know why that is it's because there is there is three things that have been released for two 2001 and instead of just creating a distinct RAR it creates three separate ones so what's the like best best way to do to make that distinct um just going to ask got so many things open sorry um just going to ask CH you here this in press when I have a and the and there are three Bs within the same year what's the best way to make it distinct that doesn't sound right but I'll try it anyway I want make multiple rows saying same thing but the values are different okay yeah that's that that sounds more right um okay no that doesn't sound right either so this is what really really annoys me about chbt it's just stupid sometimes that would work for \[Music\] hello so if I just do try okay so we've got Charlie H there and we're getting multiples here of the same thing and that's this here that's the value and if I add the distinct back in hi everyone Hi Lord hi M yeah okay that looks right so I assistin in there yeah this is a lot of garbage don't trust chat to give you anything useful but to be fair it gave me that so that that was all I needed really um but the rest of it was garbage H right cool so if I remve that now do a run that should give me the right values yeah cool um and then that needs to be another CTU so I'm going to call this those this uh and then and then I want to do select and I want the next thing I want to do is I want to do the rating and so this is going to be slightly different to what was done in the lab where I think in the lab you was just getting um the latest points whereas for this particular thing we want to get the average for for the for the current year so someone can have for the for the latest year so someone can have um the like what's it called so let's go back to um this and look at the rating this field represents an actor's performance quality determined by the average rating of movies of the most recent year so we need to get the maximum year that um the star H has in in this in this um like block um and then from that we need to get the average rating so even if like it's 2020 now but the last movie was 2010 um and they haven't put anything out since that will be the like the the last year um I'm taking that to me the most recent year that they've actually been active so that's what we're going to going to do next we're going to get the average of basically that um so okay so if I do a select um that is in film w then so say the so say we're looking at mass for example when the years 2001 he doesn't have any rating so I don't I I I don't think we would populate that for for that year um but what we would do is for the ones where we do have a rating just say we have Paul Newman in in 2001 his rating is going to be 6.2 for 2002 his rating is going to be 6.2 so he's going to get a average score for for both years but then in 2002 he's going to get an average score of 7.1 rather than um rather \[Music\] than what he had before which was um like 6.2 let me find someone who's got quite a few different ones so if we look at for example um gongi um no she didn't have or they don't have enough in one year if we look at um John here he has two ratings in 2000 so that's 5.9 plus 5.5 and so the average rating there will be 5.7 and so his will be bad like he will be match as bad but then in 2002 it'll be the 2001 2001 ratings that we take rather than the the previous one so it'll be 7.6 and 6.4 which the average of that is seven so that will be um he'll be rated as good for that year and so that's how we want to do it basically we want to be saying okay for this current year um what what is like this person's average and if it's 2 if we if we go back to here like forel oh my God I'm measuring these names um we've got 6.7 and 6.3 here um but we don't have any new ones so we we take the maximum year that's in here rather than this year we take the maximum year that's in here and then we use that to be the thing that's going to calculate the average if that makes sense to okay okay so we want to do we want to get the rating so we want to do case and then we had this code oh where have I mov the code I had earlier I had some code in here it I just deleted that I lost it forever that's fine I had so I'm going to have to write the select case stuff that I did before but we have instead we do when average of the movie so just so we've got um it's just one one second my headphones are just to be fair um I don't know why I'm wearing my headphones because I'm not listening to anything maybe I could put some music on um but my headphones have just said goodbye but it's because I'm not actually listening to anything so it did right to tell me goodbye um I'm just yeah I'm just talking crap um and for anyone who's watching me after watching the um like is that live sorry I had to leave I only have a specific amount of time in the day that I can actually like write stuff and so I was like if I don't do this now then I won't do it basically so yeah um so I'm just going to do when average is greater than eight then uh we want to have what is it star when average is greater than seven we want to have then good when average is greater than six then average else add then we end there and we push push that as I'm just going to call that rating and then it's I'm pretty sure it's that to do um uh what's the type that I created earlier quality class hey hello came from link to and yet you didn't accept my connection request um I'm really sorry I've got like 200 connection requests that I need to work through and like I I'll literally have like I'll literally leave them there for like a week or two and then I'll work my way through them and I don't always accept everyone because most people don't give any sort of indication that of of who they are or why they're connecting with me and so I can't so if if you definitely want to be connected with me all I say is to give me a me like to put a message there to kind of say like where you know me from just because I just get a lot of random connection requests so um it's much easier for me if I know who the person are I see anyone 10 hi Gabriel how are you how are you then I need to do uh from actually I need to do another select statement inside of here and I need why did did you why did you come to see me WR an sqr Gabriel why you know it better than me that's cuz you haven't watched it from the start so so that's the only reason why that's not the that's not the name oh no I don't even talk about Advent of code um no no I don't teach SQL to be fair I'm just to be fair I'm not I'm not a big SQL person I don't do it a lot so this is really testing me to be fair but um but I'm doing this more just because I'm doing the DAT engineering boot camp thing and I I'm not excited for Advent occur this year just because I remember last year when it took like so much of our lives like I just remember like getting to like day 20 and be like Oh I'm so done with this now I think I think they're they're pretty much the same thing so I wouldn't worry too much for for okay why select for for how do I cast that how's that cast okay that's fine that's w I'm going to do Nest yeah I think the FL goes in there no that's not correct um and this film's this filine so I'm not trying to use the Activia I'm trying to so say you've got a so you've got like let me just comment this out for now and then what that so you've got say you've got like three averages here oh you got plenty of adages let me find one where you got it over a few different years so so John GLE for example it's 2000 and he has all of these um films that he's been in same with 2001 he has all these films he's been in same with 2002 he's got all these films he's been in I want to get the like for the current year so so you've got 2002 I want to get the max I only want to get the max years um in here so like so like when I'm doing a select here to get the maximum years I want I only want to get this the maximum years here when maybe I need to do that is it own thing yeah maybe I need to do okay I think I know what I need to do Max um for okay this is what I want chy with you to help me um go how do I get the max years of the okay that's yes please that would be great for do that may do okay fine for okay so that looks right hopefully I just copied that isn't that garbage yeah that could probably work create a c to the aage rating and then let's do that first then for for okay I can try that this doesn't work I'm just getting rid of chat because it's a piece of crap right for a for oh for yeah I'm just reading at the moment hi for for instead of using Max film year do year use max year select ID and Max yeah but I can't do Max year cuz um it's not the year that I'm bothered about it's um so let me just do a SL star I don't want this year I want the year inside this clearly I just need to figure out how to need to do some reading on how to work with complex data types get max value no they're not the same so so you could have say thank you D you could have say um someone like Charlton for example who hasn't posted in any 2002 and so none of the values in here is going to have 2002 in there so he he that's that's a way to also figure out if they're not active as well but um but yeah you can this is the value that I need the max value inside of here though I've just figured out actually I don't need to do all this um I've just had a bit of epiphany of I just swore as well sorry for swearing \[Music\] um cuz I'm ordering this in in order of year I can just get the last one so I can just get the last one I don't need to get the max value I can just get the last one uh yeah you can um if you wanted to go to I I'll send you the repository oh hi you're there as well got this song from hsy in my head and it's just in my head yeah it's just there so you can basically just if you go to the the um homework here or well the scripts go to the read me I'll tell you how to get set up if you want to use my one as well I've got like I've added the docker compose here so if I go to the do computers I've also added PG admin so you're welcome to use mine as well if you want just cuz I've need it a bit better yeah so I think I can just do that um which is going to make it a lot easier a lot easier so right cool that's a lot easier um cuz then rather than having to do all of this and then I can do do \[Music\] yeah some films the homework okay I'm going to add there and I'm going to make that in integer okay okay I'm making progress things are going well then I do I then that is hopefully right I think yeah good that is good I'm just going to do I'm going to put you in that as well because I want to see what that brings up as as last VI must active year okay does anyone actually think this is is useful because I'm just kind of blagging this at the moment I don't know poststress very well I've been very humbled over the last day very humbled okay so I'm happy with that I'm going to create a last active year as this and then okay so now we have the last AC of here for each person and then we can do a select for for hello that for thank you um I'm still like hoping maybe chat gbt is helpful but usually it's not very helpful complex data type in post with fields that this is the first week homework I need to get the average of the of the specific year of in that AR how will I best this is what I have so far going to start again average or average ratings for the next year okay this feels just like I'm making a really really ugly ugly thing at the moment but I can always we find it later for mhm yeah yep for for is waiting okay that's okay so that's a good example of one that has two different ratings one year which is good we are getting there then do group b hopefully that will do that do you take for just going to remove that one I don't think that's going to give me what I want that again okay for hey hi Carlos how you doing currently I am figuring out how to get the rating average rating for the last year for so Okay so and P no I don't play video games that's not adding up though why is that data different to what I expect it to be okay I like okay so we got these people here make that bigger for now I'm actually going to copy all of his data I think it's a good test subject yeah of course so I am debugging the I'm trying to debug the query that I've done so um if I go back to so if I unselect this and I go back to here and I remove this and I select the last year for for each of the years so this year's last activ year is null um in two in 2000 um and let me try find where actor equals and so I'm just debuging this script that I've written so I've got this select statement here for for for Aon Paul and we can see in 2000 his last active year was 2000 in 2001 his his last active year was 2001 and in 2002's last last active year is 2002 so I trust that that's right so I'm happy with this as it being last um yeah yeah I can add music I'm not sure you'll like my music though um so with so must and I'm going through and I've got my last AC of you here and then I'm saying okay I also want to unest all the the the films so so if I just go here I'm going to un Nest all of my films and the reason I'm unnesting all the films is because I need to um I need to calculate the average rating basically for the last year for for so just say I'm in 2002 now but the last Act of year was 200 2001 and just say I did three movies in 2001 so say I did 1 two three m these I don't want to get the ratings from 2000 I don't want to get any other the ratings just 2001 and I want to get the average ratings of of it and so should exist should exist there and so um that's what I'm doing on deog basically okay so I've got um my un nested queries and I'm just going to do a where well this is what when it was our in PA before so these are all the things that we care about and then I want to do a another query to get for for I only get the want to join the unlisted films and the last AC of year so just say in here the year is 2001 and the last Act of year was also 2001 I then want to yeah I didn't want to only bring back results that have both of those together \[Music\] um so if I put this back in as it's mad how don't you think it's mad how like um you think it's mad how like yeah that's true C is probably not not going to be good um don't think it matter how like easy like a a trainer makes this stuff seem cuz you're just like what the hell for e so for some reason this join isn't um isn't actually adhering to this query here which is where we join on the you the last out to here what happens then it's just a decaf te to be fair e okay why how different am I in live versus on LinkedIn yeah I'm not trying to be funny when I'm learning how to write a query to be fair it's a different um it is it's a different skill set when I'm trying to concentrate do this need to happen in a single query run or one query at a time good question um right I'm going to park the thing and I'm going to at least do the isactive I know I know what I need to do for that one at least so I can at least do that one for for I keep thinking I'm writing an M code yeah so so he did but he also has this select generate series that you can do which allows you to then popul it for a few different years so that's what I ended up using for this one so I could test it do I take New neut Tropics what's New Tropics is that like is that like ADHD Med medication or something for what do you do in as Jo for no I don't really do that I um I just take um Regular British tea for cool so I was just missing the af. year equals last year um and I'm creating this query here which is fine which is fine okay I am I think I'm happy with where I've got tonight um yeah I definitely I'm going to do some reading up on the best ways to get um the average from like a like area of data structures like within post SQL cuz that seems to be like quite tricky like from what I can see um but if anyone has any resources on how to get the average um from a like particular value within um within like my brain's gone to Mush now if anyone has any reading resources for how to get the like average rating in a complex um type that would be really really useful I am not jenzy I am a millennial so I am 1 years old at the moment but yeah I think we're doing well we've got the we go and refresh the tables we're now at the point where we've got the actor the actor ID the current year the films um is active and the only thing left to do is to get the quality um Quality class I think for for I'm just going to check a few of these yeah so we seem to be getting the right data for those as well which is good yeah thank you so yeah we seem to be getting good data false and true and then in here it's true and false so things definitely improving I'm going to save this as data modeling okay so is a save as so I'm going to add this back I'm going to add that other condition and uf. year equals thank hey you e for I don't think we should nest it to be fair I'm going to not bother nesting because I don't think that's the right thing to do I think we need to use actors and activ use still you can die \[Music\] get just going to do fils for now put now could here isn't \[Music\] she isn't she e okay okay so we're getting close we just need to for for for that's for for for for for for for e for you can do back after a while can you okay so should be should that's right we don't need those so it shouldn't be those we shouldn't be we shouldn't be having to add those okay for I think we might have done it I think we might have done it hi Emanuel how are you doing hope you're doing well how are things going um for I'll leave that for now that's fine do find it interesting though it's got these there uh where do I go the the you know what I'm going to get rid of this I'm going to do um with ratings as this and then I'm going to remove those I'm going to remove the P bit and then I'm going to do another select for everything else I'm going to do um from and I'm going to do a join on GI okay uh and then we've got s = a ID and a AF dot current year equals a here rating 2002 5.3 6.1 \[Music\] awesome there's a couple here think we've got it I'm just going to i' got so much on here 6.1 and 7.6 and 6.6 okay so it's definitely taking the average of that which is good so if I do 6.6 plus 6.1 plus 7.6 and I divide that by three that's 6766 666 which is that there um pretty much it's a far but yes sure that's right then if I don't cast that as a wheel I will bother for know and then 5.6 4.9 and 6.3


 > [!info]
> - The presenter is working through a Data Engineering Bootcamp homework assignment (0:07)
> - The presenter is using SQL to analyze data related to actors and their movie ratings. (24:07)
> - The presenter is debugging a query to get the average rating for the last year an actor was active. (1:21:18)
> - The presenter is exploring different ways to structure the SQL query to achieve the desired result. (1:43:06)
> - The presenter has completed the homework assignment (2:23:01)