---
title: "Spring Boot Debezium - Master Slave Real Life Project Example"
author:
  - "Java Puzzle"
published: 2024-02-10
source: "https://www.youtube.com/watch?v=n0m6r0kXZh8&list=LL&index=152"
image: "https://i.ytimg.com/vi/n0m6r0kXZh8/maxresdefault.jpg"
created: 2025-03-20
tags:
  - "youtube"
  - "Spring_Boot_Debezium"
  - "Master_Slave_Architecture"
  - "Change_Data_Capture"
summary: "Learn how to implement Change Data Capture (CDC) in a master-slave architecture using Spring Boot and Debezium. Step-by-step tutorial with real-world scenarios."
---
# Spring Boot Debezium - Master Slave Real Life Project Example

![Spring Boot Debezium - Master Slave Real Life Project Example](https://www.youtube.com/embed/n0m6r0kXZh8&list=LL&index=152)

> [!summary]- Description
> In this tutorial, we will explore how to implement Change Data Capture (CDC) in a master-slave architecture using Spring Boot and Debezium. This demonstration is targeted towards teenagers, developers, programmers, and students looking to expand their knowledge of CDC and its implementation in real-world scenarios.
> 
> Inside this video 📺, you will see:
> 
> To implement Change Data Capture (CDC) in a master-slave architecture using Spring Boot and Debezium, you can follow these steps:
> 
> Setting up the Database:
> Set up your database (e.g., MySQL, PostgreSQL) with the required tables. Ensure that binary logging is enabled in your database settings. 🛠️
> 
> Add Dependencies:
> In your Spring Boot project's pom.xml, add dependencies for Spring Boot, Debezium, and the database connector (e.g., debezium-connector-mysql). 📦
> 
> Configure Debezium:
> Configure Debezium in your Spring Boot application. This involves setting up properties like database connection details, CDC configuration, etc. Configure Debezium to use the appropriate connector for your database (e.g., MySQL, PostgreSQL). ⚙️
> 
> Define Kafka Connect Configuration:
> Define the Kafka Connect configuration file to specify the source database, topics, and other configurations. 📝
> 
> Implement the Consumer/ Listener:
> Implement a Kafka consumer in your Spring Boot application to consume the change events published by Debezium. Process these change events and apply them to your slave database accordingly. 👩‍💻
> 
> Replicate Changes to Slave Database:
> Use the information from the consumed change events to apply the corresponding changes to the slave database. Implement mechanisms to handle data consistency, error handling, and conflict resolution if needed. 🔄
> 
> Handle Data Transformations:
> If required, transform the data before applying it to the slave database. This might involve mapping data types, restructuring data, etc. 🔄
> 
> Ensure Fault Tolerance and Scalability:
> Implement fault-tolerant mechanisms to handle failures gracefully. Consider scalability aspects to handle large volumes of data and concurrent requests. ⚖️
> 
> Testing and Monitoring:
> Test the CDC implementation thoroughly to ensure correctness and reliability. Set up monitoring and logging to track the CDC process and identify any issues promptly. 🧪🔍
> 
> Deploy and Monitor:
> Deploy your Spring Boot application along with Kafka and Debezium components. Monitor the CDC process and database replication to ensure smooth operation. 🚀🔍
> 
> \#ChangeDataCapture \#CDC \#SpringBoot \#Debezium \#MasterSlaveArchitecture \#KafkaConnect
> 
> Don't miss out on this insightful tutorial that provides a professional, step-by-step guide for implementing CDC in a master-slave setup using Spring Boot and Debezium.
> 
> 🔍 Github link: https://github.com/sawankarn/spring-boot-debezium-master-slave-example

> [!note]- Transcript (Youtube)
> Hello friends welcome to the jav puzzle today in this video we are going to continue our previous video where we will discuss about the devium how to configure the devium how to configure our post SQL connector then we run our uh small demo over we will insert update or delete some values in our postas SQL and then we see how our Kafka is uh getting the details so all these things we we already seen in previous video if you don't check that so please check and then come back to this video then you can understand how we are uh going ahead so in this video we are going to implement our spring booot application and where we will integrate our Dum okay so as we add this uh Swagger in our main pom.xml because this is a multimodule so in Main pom.xml we added so for the both of the application this Swagger will work so firstly what I will do I will firstly uh create one configuration class for our Swagger where we will give the different name for the master and for the slaves so we will not conf uh confuse in future when we will run both of the Swagger to check our uh work workflow right so firstly I will just create uh Master Swagger config firstly it could be annotated with a configuration because this is a configuration class then firstly we have to create one bean and inside this pin this would be uh returning uh group open AI custom open API okay and it will return our group to open AI builder. build and so what details we need to add here we need to give the group name okay so group and here we will just provide our group name as a deum master post CR SQL API then we need to provide our uh package to scan and here we have to just provide our package for the controller so it would be com. YouTube Java puzzle controller so we are good here okay now let's move to the other part same uh I will add for the slave also so so in future I don't have to create this so I'll just copy it and paste here uh I'll just change it to slave and rename the file also copy this okay other thing is done so let me cl okay now let me create a entity first so let me minimize this and go in entity create a class as a customer customer okay and entity I'll add here so inside it uh we just added ID full name and email just for Simplicity I'm not uh giving the uh full uh attributes just only these three values okay just for Simplicity nothing much uh we are thinking here okay because main thing is to connect our devium with a spring Boot and fulfill our purpose to implement to gener create a Master Slave work okay so after the entity let me create a repository also and customer rep repository so we add our uh customer depository now let's move this is a simple one okay uh nothing much we are doing here this is this would be a simple uh simple application where we are just going to insert delete or update our value okay our customer details only so nothing much is here so you can also escape this but I just I want you to uh come with the flow so you don't miss anything in between so customer service so inside this customer service uh we have a customer repository then we autowire this then get all customer get customer by ID create customer update customer delete customer so I'm not going to uh explain all these things because this is a simple one uh simple example of any cred application using the springboard so I'm thinking you are already if you are following this video so you already uh know everything about this so I'll just quickly create the customer content controller so now uh this controller we have all these end points which uh which call the service map so we have a master Services uh completed so let me let me quickly open uh let me check uh this pz admin is running over the 5051 so let me open pz admin in the browser okay so firstly I have to run the service and so all are the started fine so all the parts are up let me check check so yeah all the imag is running now uh let me open the post SQL and add the given uh default username password me copy this uh copy this and copy this name run it okay so because uh it's restarted always so I have to again configure the server so Java puzzle connection would be post Docker Docker uh connect Docker docker oh sorry talker and this name should be dum Master given here Dum Master it now in a Java puzzle we have a database which is a deism master we have this schema and public so in previous video uh we will create a customer table here and then uh we will insert some data and check there right but in this video we are not going to create anything because this is a spring boot we'll take care of Okay so so I'll just and one more thing uh I'm also not going to configure any uh what we can say uh connector deism connector right if you will see here in a none because this is a get if I will run this so here you will see currently there is no any connector right because we are not going to ex uh externally we are going to hit this okay this will all thing will be happen in a through the spring board okay so for now uh we are good to go currently uh this is a simple application we didn't do anything we are not going to configure anything with the Dum or springboard here okay because that will be happen in a slave surface so till now we are good and uh let me run the application which will create a customer table for us enable the longbox and uh okay uh the resource is blank okay huh so let me create here the application. property file and then add the details inside it okay so it will run over the 9080 then DM Master Docker Docker and if database is not create exist then it will create it okay so let's save and run this application so it's create the table here okay now it's running now let me go to the browser then uh let me check 9080 chat 9080 host 9080 so just change it to 9080 it's Swagger okay and Let me refresh it so here our table should create it customer is here let me see if everything is working then we will go ahead okay so get API currently nothing will be here okay click on the post try it out just change it to Java puzzle author at Java puzzle.com execute it so data is here let me check the get API cute so it's in inserted and we can see here okay and uh query also you can see the insert and select is running okay so this is a basic part okay uh where we Implement our Master service okay and now the main part is going to start so I just want your all focus should be here this uh slave application what is the purpose of this so whenever the master service will hit some data in the DB in post SQL DB then this slave service will listen that topic which is uh created by the de asium and it will listen that topic and uh it will insert the data in the MySQL DB so uh for this we need to create a resource here so firstly I'll create one file which is a application do properties and add the my sped okay and in the pom.xml also I need to add okay so I already added the MyQ dependency here so application properties is here now let me quickly create the entity class same entity I can copy because I'm just duplicate the data from the post SQL to mySQL now so customer and let me copy the customer entity from here okay so I'll just copy this and paste in the Slate okay so after the customer uh I need a repository so I'll copy this repository also and paste here this is also fine then uh I have a customer service so I'll copy this service also okay then uh uh this controller also I required so I copy and okay and for differentiating this let me open this slave and this one would be the deum slave MySQL API so let me quickly run this application and just see in MySQL also I'm able to insert the data so firstly I'll open my MySQL workbench just just connect it uh So currently let me it's old one so let me uh drop this schema okay now let me run the slave application so our slave service application is start okay so let me refresh it and DM slave is created in the table customer is also created select row currently nothing is here okay so I'll just open uh the Sager UI for the slave one uh which is running over the 9081 so here you can differentiate this is a deum slave MyQ API and this is a deum master postest API okay this is a slave this is a master okay so let me insert some value first so I'll just uh copy this post okay copy this and uh try it out just for understanding I'll just change it to S Kumar then 7 at jav puzzle. execute it it's inserted let the get API run and data is here and here also we can run this and we can see the data okay so we are good now okay our both of the service is working now okay what we have to do now uh we have to implement our deum so for this uh let me open the uh just minimize it okay so in slave service in application property because we have to listen the data uh devium connector topic so this is the definition uh property for the slave data source uh so this slave data source which is a local host it should be uh not slave it should be the master right so Master Okay so this is a master data source which we are going to connect with the de devium okay this is a database tum Master you can check here in the source in the resource so here you can see anything change here why save okay so I'll just close other Tab and open this property from the SL slave here you can see this D Master username password okay all thing we provided in the slave okay Local Host is a host name then Port then database username and password of the master table okay so now we need to create uh DM configuration class okay so TM connector config okay so in previous video we are uh hit the postman to register our connector right but this time we are not going to hit this Postman we are going to add the configuration okay and through this configuration it will it will hit all the connector so here I'll just create a bean first inside this Bean we need to provide our configuration from the devium so when I run this uh when I uh write this configuration so can see configuration so this would be come okay uh currently this is not coming because we didn't add the devium property uh dependency in our slave so let's go in a pal. XML and add the property as a deism version 2.4 zero final we are using here and let me minimize this and let me add the deum dependency here okay so deism API WM embedded and WM connector post so if you are using for mongodb or MySQL so if I will remove it and control space so you can see there is a multiple connector is present okay so you can use anything so for now for this video I'm going to use this post okay now reload this so after loading completed then if I will control space it now you can see uh in configuration there is a iio de asium config configuration so I'll just click on it then here custom uh customer connector inside the parameter I'll just provide the environment from the here EnV because we are going to provide the envirment from the property file where we will Define our uh post SQL details okay then I'll add the other configuration so before adding it so uh this Bean annotation is uh commonly used in Spring uh spring framework to indicate that this method produce a bean to manage by the spring container so that's why we uh created this pin here and in this case the method is responsible for creating a daium configuration beam so this method is customer connector okay and it take this environment as a parameter environment object as a parameter inside this method you can see we are using this iio devm config configuration okay this is uh this class is used to build a configuration for the devm connector then we have uh this name okay where we will provide the connector name as you can see here this name is the which we provided in a previous video same we are doing here okay then we have some other details like uh connector details such as a class right then name uh the connector class we provide here post SQL connector then we have the server ID server name then uh uh provided here then we have some database details okay which we are getting from the environment property from application property of the slave application uh which is the master data source host Port username password and the data then we have a offset storage this one okay offset storage detail using a file based storage mechanism then other configuration parameter such as the topic prefix database history and the publication Auto uh create mode then we have some uh plug-in name then slot name okay these are the some details and uh you can see here I comment uh the these two line so if we will comment this that means uh it will it will check all the changes in the all the table okay and if we want to specify some table then we can use this so for now I'm just commenting it okay uh I o provide the this whole uh code in in the description section the GitHub Link in I'll provide in the description section you can check out okay and you can uh experiment with this tool line okay for now uh we're good here and let me run the application and see what will happen so I will rerun the master service master service is not required but yeah before doing uh this I'll just uh remove this this customer table okay just delete it okay so fresh details would be there and same I will do for this one Al drop the table okay nothing would be here now let me run the both of the application and see what will happen so run the master and run this fuing debug but no issue let it run in a debug only so it's closing what happened let me see okay it's creating again so slave Serv is currently running let it run first so it's running okay and yeah it's started and let me run the Master Slave is running here why why why why it is let me check 9091 is running this is a slave and 9090 this is a master so just to verify uh let me try out this cat API so nothing is present here and for here also try it out and hit it currently in both of the table we don't have any data now what will happen when uh I will hit this master posters SQL DB then it will call the deum connector and the deum connector will insert the data in a MySQL and then we will fetch the data here okay in a slate so let's me run this so post uh try it out and just delete it full name is Java puzzle as you us then uh we have a user at javap puzzle.com so when I insert it when I execute it it's running here okay so in post SQL also I'll just refresh it in the DB customer DB uhing here no issue script or all the row so data is here now let me see here in the get executed currently it's not running so you can see here data is not not inserted in the my schol why because we we are hitting here okay it's calling our daium okay but we are not going to listen till now okay so firstly we have to create in a slave uh let me create one more package which is a listener okay inside this listener let me create a class which is a tabasum listener okay uh this would be a component okay and here okay so component then inside it firstly uh because it will run over the executor so I'll just create uh private final executor and I'll create a object of executors exors and new single thread okay I create one object here then we need to uh we need to provide uh our daium engine also so let me create a private final dum and in deum you can see here is the daium engine and inside it we need to provide our record change event okay this one would be a record change event and this record change event is contain this Source record okay and DM engine so what it is complaining at the Constructor parameter okay so I'll just add the Constructor parameter inside it okay then uh and we also need because when we will listen uh this TM changes uh then what we are going to do we are going to insert in our table okay so for that thing uh I'll just uh add here the customer service okay so we will use and inside it I'll just add this uh after this stasium so here uh let me add let me remove this first okay uh we will not create here uh firstly I will Implement here the configuration from the daium okay configuration which would be not configuration be customer configuration customer configuration okay and the other thing I'll add this customer copy this okay so for this I'll just this do customer service is equal to customer service okay so this Auto is fine now the next thing is we need to provide this tab as engine okay this is a customer configuration which we created and we will just provide so this tabm engine we need to provide here M engine dot there is a create okay inside it we are going to what type of parameter it is asking change event format right so change event format. off and here we just provide the connect do Class Connect do class do using what we are going to use here we we are going to use our customer configuration customer creation connector configuration dot as property as property we will use it okay then we are going to notify so notifying this and the handle change event okay let me create this create this method okay dot build okay so this configuration is we provided here WM connector configuration okay then this configuration we are using as a property and then notifying this method okay so this deum engine is now configur okay and also let me add some more property for the Post construct okay whenever it will run so private void start and here we have to provide this executor do execute and inside it we have to give the de so deism engine will run then at the last when this will be uh destroy then pre- destroy when this pin will be destroyed so in that case we need to call this method private vo stop okay and here what we have to do if uh objects do non null then this do dum engine okay so if this this do TM engine is not null means it is running then what we are going to do we are going to close this okay and uh this will add the exception here I exception okay so we are good now we will Implement what we will do when we got some changes here okay so let expand this so here we Implement our handle changed event okay so this source code contain all the key and values here and here A struct type and uh then record change value is not null then so this handle change event method method is act as a listener for DM recorded change event in a spring boot application and this listener is especially designed to handle event related to change in database table using the deism as a CDC or we can say change data captured so if we will see here this method name is contain This Record change event as a parameter and this DM capture change as resource record okay instance and the record change event is provide information about the changes event then it extract The Source record right Source record from the record change event so when we call this record it will provide us a source record here then we are locking it so we can see what is the key and what is the value provided by The Source record then from The Source record we are just getting the value because we need only the value to insert in in our DV or do the other process so Source record change value is is have the value from The Source record then we have uh then we are going to check is this Source record value is null or not null if it is not null then we are we are going to retrieve the operation okay we we know we we want to know like this is a insert it's a create or update or delete so this operation will return what type of query is HED over the DB so it can be create it can be update it can be delete so if I will open this and I'll show you uh this operation these are the operations we have okay so read create in update delete trunk it and M so accordingly we can perform other application uh our operation okay so for now we are just going to check this operation. read should not be here because we need the delete or insert or update these three things we required here so it check that the operation is not a read operation because listener is interested is handling only the create okay update and delete so in this case when this will success then we are just checking that if operation is delete then we just need a record before okay and if it is not delete then we need the after because if if record is deleted then after will be the null so we require only the before we don't require the after and if it is inserted then before will be the null and after have some value okay so in this case uh and also for the update scenario also if it is not if it is update then also we require the after because in before case after and before have some value but we need only the after here okay for our scenario so that's why we just add the condition if it is delayed then we will check only the before and if it is not delayed if it is insert or update then we will check the afteron okay then we need to then we are going to extract our payload using this okay and then using this payload you can see in the customer service we have a another another method we created replicate data okay and in the replicate data you can see we are providing the map string customer data and then we have an envelope do operation and inside it we are going to firstly create a object of object mapper so we can easily uh map our object then inside it this map to customer here you can see we are just set our data from the map to the customer and then we are returning the customer okay so now we have a customer details here okay I also add the debuger I'll show you all the process and then we will check if this is a delete operation then we are going to delete our ID our record and in case if it is update or insert then we are going to save the DAT so this is a clearcut operation we are performing here okay and at the last we are going to log so let me run the application again okay so let me open the master so we run here enable The annotation here so let me run the master Master application so it's up and running uh let me do one thing uh I'll go in customer and create here okay I'll add the debugger here here only this fine uh we are in a controller right so I'll I'll run in a debug mode so I show you how our debugger will go from one application to another application okay so this one is done okay now go in a slave service application and I'll run this slave also in a debug let it run also Master's here and master service running here okay and slave service is running here so replica identity is also run by our spring application we don't have to do anything right so we are good now let's go to the browser and see the work so let me refresh this and Let me refresh this one also so as we know that this is a master this is a slave so let me firstly validate this again everything thing is blank here and let me validate here also try it out execute it so everything is good now let me post now okay so post it write out so full name is Java puzzle as usual uh puzzle then author at Java puzzle.com and when I H execute it so it will go in a master okay Master controller let me close other So currently we are in a controller of the master application and here we will see all the details are here ID is null because we don't have ID for now when I will run this so so now it will go in a deim listener which is present in the slave application and here you will see so here you will see and when I go below uh let debug mode here you will see one record sent during the previous record okay so if I will go below step over and and you will see this data is showing here okay so ID is one email is this and full name is this okay then I'll go below so key and value both are coming here okay then uh we will see this record CH uh Source record change value is coming here with the schema and value inside this value we need here these are the DAT okay then go below here and operation so if you will see the operation is create okay so create that means it it will go inside it it's a true then we will go here and see here currently record is coming as we need after right so go below so these are the all detail inside this map okay I'll show you the payload inside it there is the three dets ID full name email okay I will run this and here you will see it will go inside the save method and it will store the data so let me validate in the browser and here you will see updated data is this these are the detail and operation is create and in the browser and let's go in the slave part okay and if I will execute it here you will see same data is coming okay now let me update it okay so I'll go inside the put method then I'll trite out provide the one and let me copy this value one get it okay this just change here I don't require the ID here because ID we are provided above and here I will just change Java puzzle to savan Kumar and execute and let me skip this okay and again go in the browser and firstly run okay so it's updated now here you will see when I execute this now you will see the data is changes here okay let me let me change the email also so sa at Java puzzle execute it and here if I will execute it here you will see the email is now I will uh delete it okay and then we will see the data is there on so try it out one executed data is deleted here and if I will again execute this so no data is present here so I think this will uh you understand how this tab ASM is work and how we can going we are going to implement in our spring application okay so hopefully this video is helpful for you and if you think this video is helpful then please share with your friend and like And subscribe my channel for the night thank you


 > [!info]
> - **Set up your database with binary logging enabled** (0:07)
> - **Add dependencies for Spring Boot, Debezium, and database connector** (0:07)
> - **Configure Debezium** with database connection details and the appropriate connector (0:07)
> - **Define Kafka Connect configuration file** to specify source database and topics (0:07)
> - **Implement a Kafka consumer** in your Spring Boot app (0:07)
> - **Replicate changes to the slave database**, handling data consistency and error handling (0:07)
> - **Handle data transformations** as needed before applying data to the slave database (0:07)
> - **Implement fault-tolerant mechanisms** and ensure scalability (0:07)
> - **Test the CDC implementation** thoroughly, set up monitoring and logging (0:07)
> - **Deploy and monitor** the Spring Boot application and Debezium components (0:07)